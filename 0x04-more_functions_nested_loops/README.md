more functions and nestetd lopp
